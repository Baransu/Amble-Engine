<link rel="import" href="../../bower_components/polymer/polymer.html">

<dom-module id="transform-component">

	<style>

	.head {
		width: 100%;
	}


	</style>

	<template>

        <div class="card">

			<div class="card-header">
				<div class="row">
					<div class="col-md-9 text-xs-center">
						<a class="btn btn-success btn-sm head" role="button" on-click="hideComponenet">
							Transform
						</a>
					</div>
					<div class="col-md-2 text-xs-right">
						<div class="btn-group">
							<button type="button" class="btn btn-primary btn-sm dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
							</button>
							<div class="dropdown-menu dropdown-menu-right">
								<h6 class="dropdown-header">Transform options:</h6>
								<div class="dropdown-divider"></div>
								<a class="dropdown-item" href="#" on-click="reset">Reset</a>
							</div>
						</div>
					</div>
				</div>
			</div>

            <div class="card-block" hidden$="{{hideConent}}">
				<div class="container-fluid">

					<div class="row">
						<div class="col-md-6">
							<div class="form-group form-group-sm">
								<label>position.x</label>
								<input id="posx" class="form-control" type="number" step="1" on-change="valuesChange" value="{{actor.transform.position.y::input}}">
							</div>
						</div>
						<div class="col-md-6">
							<div class="form-group form-group-sm">
								<label>position.y</label>
								<input id="posy" class="form-control" type="number" step="1" on-change="valuesChange" value="{{actor.transform.position.x::input}}">
							</div>
						</div>
					</div>
					<div class="row">
						<div class="col-md-6">
							<div class="form-group form-group-sm">
								<label>scale.x</label>
								<input id="scalex" class="form-control" type="number" step="0.01" on-change="valuesChange" value="{{actor.transform.scale.x::input}}">
							</div>
						</div>
						<div class="col-md-6">
							<div class="form-group form-group-sm">
								<label>scale.y</label>
								<input id="scaley" class="form-control" type="number" step="0.01" on-change="valuesChange" value="{{actor.transform.scale.y::input}}">
							</div>
						</div>
					</div>

	                <div class="row">
						<div class="col-md-12">

		                    <label>rotation</label>
		                    <input id="rot" class="form-control"type="number" step="0.1" on-change="valuesChange" value="{{actor.transform.rotation::input}}">

						</div>
	                </div>

				</div>
            </div>

        </div>


	</template>

</dom-module>

<script>

	Polymer({
		is: 'transform-component',

		properties: {

			actor: {
				type: Object,
				value: null,
				notify: true,
				observer: 'refreshActor'
			},

			hideConent: {
				type: Boolean,
				value: false
			}

		},

		reset: function() {

			if(this.actor) {
				//position
				this.actor.prefab.transform.args.position.args.x = this.actor.transform.position.x = 0;
				this.notifyPath('actor.transform.position.x', this.actor.transform.position.x);
				this.actor.prefab.transform.args.position.args.y = this.actor.transform.position.y = 0;
				this.notifyPath('actor.transform.position.y', this.actor.transform.position.y);

				//scale
				this.actor.prefab.transform.args.scale.args.x = this.actor.transform.scale.x = 1;
				this.notifyPath('actor.transform.scale.x', this.actor.transform.scale.x);
				this.actor.prefab.transform.args.scale.args.y = this.actor.transform.scale.y = 1;
				this.notifyPath('actor.transform.scale.y', this.actor.transform.scale.y);

				//rotation
				this.actor.prefab.transform.args.rotation = this.actor.transform.rotation = 0;
				this.notifyPath('actor.transform.rotation', this.actor.transform.rotation);
			}

		},

		valuesChange: function() {
			//apply object changes to prefab
			if(this.actor) {
				//position
				this.actor.prefab.transform.args.position.args.x = this.actor.transform.position.x;
				this.actor.prefab.transform.args.position.args.y = this.actor.transform.position.y;

				//scale
				this.actor.prefab.transform.args.scale.args.x = this.actor.transform.scale.x;
				this.actor.prefab.transform.args.scale.args.y = this.actor.transform.scale.y;

				//rotation
				this.actor.prefab.transform.args.rotation = this.actor.transform.rotation;
			}
		},

		refreshActor: function() {
			if(this.actor.sceneID) {
				var sceneID = this.actor.sceneID;
				this.actor = Amble.app.scene.getActorByID(sceneID);

				this.valuesChange();
			}
		},

		hideComponenet: function(){
			this.hideConent = !this.hideConent;
		}

	});

</script>
