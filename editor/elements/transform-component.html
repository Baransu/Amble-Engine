<link rel="import" href="../../bower_components/polymer/polymer.html">

<dom-module id="transform-component">

	<style>

    .panel {
		margin-top: 20px;
	}

	</style>

	<template>

        <div class="panel panel-primary">
			<div class="panel-heading">
				<div class="row">
					<div class="col-md-6" on-click="hide">
						<h3 class="panel-title">Transform</h3>

					</div>
					<div class="btn-group">
						<button type="button" class="btn btn-default dropdown-toggle btn-xs" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
							Options <span class="caret"></span>
						</button>
						<ul class="dropdown-menu">
							<li><a href="#" on-click="reset">Reset</a></li>
						</ul>
					</div>
				</div>

			</div>
            <div class="panel-body" hidden$="{{hideConent}}">
				<div class="container-fluid">
					<div class="row">
						<div class="col-md-6">
			                <form class="form-horizontal">
			                    <div class="form-group form-group-sm">
			                        <label>position.x</label>
									<input id="posx" class="form-control" type="number" step="1" on-change="valuesChange" value="{{actor.transform.position.y::input}}">
			                    </div>
			                    <div class="form-group form-group-sm">
			                        <label>scale.y</label>
			                        <input id="scaley" class="form-control" type="number" step="0.01" on-change="valuesChange" value="{{actor.transform.scale.y::input}}">
			                    </div>
			                </form>
						</div>

						<div class="col-md-6">
							<form class="form-hotizontal">
			                    <div class="form-group form-group-sm">
			                        <label>position.y</label>
			                        <input id="posy" class="form-control" type="number" step="1" on-change="valuesChange" value="{{actor.transform.position.x::input}}">
			                    </div>
			                    <div class="form-group form-group-sm">
			                        <label>scale.x</label>
			                        <input id="scalex" class="form-control" type="number" step="0.01" on-change="valuesChange" value="{{actor.transform.scale.x::input}}">
			                    </div>
			                </form>
						</div>
					</div>


	                <div class="row">
						<div class="col-md-11">

		                    <label>rotation</label>
		                    <input id="rot" class="form-control"type="number" step="0.1" on-change="valuesChange" value="{{actor.transform.rotation::input}}">

						</div>
	                </div>

				</div>
            </div>
        </div>


	</template>

</dom-module>

<script>

	Polymer({
		is: 'transform-component',

		properties: {

			actor: {
				type: Object,
				value: null,
				notify: true,
				observer: 'refreshActor'
			},

			hideConent: {
				type: Boolean,
				value: false
			}

		},

		reset: function() {
			//position
			this.actor.prefab.transform.args.position.args.x = this.actor.transform.position.x = 0;
			this.notifyPath('actor.transform.position.x', this.actor.transform.position.x);
			this.actor.prefab.transform.args.position.args.y = this.actor.transform.position.y = 0;
			this.notifyPath('actor.transform.position.y', this.actor.transform.position.y);

			//scale
			this.actor.prefab.transform.args.scale.args.x = this.actor.transform.scale.x = 1;
			this.notifyPath('actor.transform.scale.x', this.actor.transform.scale.x);
			this.actor.prefab.transform.args.scale.args.y = this.actor.transform.scale.y = 1;
			this.notifyPath('actor.transform.scale.y', this.actor.transform.scale.y);

			//rotation
			this.actor.prefab.transform.args.rotation = this.actor.transform.rotation = 0;
			this.notifyPath('actor.transform.rotation', this.actor.transform.rotation);
		},

		valuesChange: function() {
			//apply object changes to prefab
			if(this.actor) {
				//position
				this.actor.prefab.transform.args.position.args.x = this.actor.transform.position.x;
				this.actor.prefab.transform.args.position.args.y = this.actor.transform.position.y;

				//scale
				this.actor.prefab.transform.args.scale.args.x = this.actor.transform.scale.x;
				this.actor.prefab.transform.args.scale.args.y = this.actor.transform.scale.y;

				//rotation
				this.actor.prefab.transform.args.rotation = this.actor.transform.rotation;
			}
		},

		refreshActor: function() {
			if(this.actor.sceneID) {
				var sceneID = this.actor.sceneID;
				this.actor = Amble.app.scene.getActorByID(sceneID);

				this.valuesChange();
			}
		},

		hide: function(){
			this.hideConent = !this.hideConent;
		}

	});

</script>
