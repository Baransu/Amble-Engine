<link rel="import" href="../bower_components/polymer/polymer.html">

<dom-module id="renderer-component">

	<style>

    .title {
		/*color: red;*/
    }

    .content {

    }

	</style>

	<template>

        <div class="tranform"  hidden$="{{hideRenderer}}">
            <div class="title" on-click="hideComponent">
                Renderer
            </div>
            <div class="content" hidden$="{{hideContent}}">

				<!-- rect renderer -->
                <div class="row" hidden$="{{typeofRenderer('RectRenderer', actor.renderer)}}">

					<div class="row">
	                    <div class="col left">
	                        <label for="size-x">size x</label>
	                        <input id="size-x" type="number" step="1" value="{{actor.renderer.size.x::input}}">
	                    </div>
	                    <div class="col right">
	                        <label for="size-y">size y</label>
	                        <input id="size-y" type="number" step="1" value="{{actor.renderer.size.y::input}}">
	                    </div>
	                </div>

					<label for="layer">layer</label>
                    <input id="layer" type="number" step="1" min="0" value="{{actor.renderer.layer::input}}">

					<label for="color">color</label>
                    <input id="color" type="text" value="{{actor.renderer.color::input}}">


				</div>

				<!-- sprite renderer -->
				<div class="row" hidden$="{{typeofRenderer('SpriteRenderer', actor.renderer)}}">

					<label for="layer">layer</label>
                    <input id="layer" type="number" step="1" min="0" value="{{actor.renderer.layer::input}}">

					<label for="sprite">sprite</label>
					<select id="sprite" on-change="spriteChange">
						<template id="spriteList" is="dom-repeat" items="{{ sprites }}" as="sprite">
							<option value="{{sprite.path}}" selected$="{{selected(sprite.path, actor.renderer.sprite)}}">
								{{sprite.path}}
							</option>
						</template>
					</select>

				</div>

				<!-- animation renderer -->
				<div class="row" hidden$="{{typeofRenderer('AnimationRenderer', actor.renderer)}}">

					<label for="layer">layer</label>
                    <input id="layer" type="number" step="1" min="0" value="{{actor.renderer.layer::input}}">

					<label for="sprite">sprite</label>
					<select id="sprite" on-change="spriteChange">
						<template id="spriteList" is="dom-repeat" items="{{ sprites }}" as="sprite">
							<option value="{{sprite.path}}" selected$="{{selected(sprite.path, actor.renderer.sprite)}}">
								{{sprite.path}}
							</option>
						</template>
					</select>

				</div>

				<!-- anchor? -->
            </div>

			<div class="divider"></div>

        </div>


	</template>

</dom-module>

<script>

	Polymer({
		is: 'renderer-component',

		properties: {
			actor: {
				type: Object,
				value: null,
				notify: true,
				observer: 'refreshActor'
			},
			sprites: [],
			hideContent: {
				type: Boolean,
				value: true
			},
			hideRenderer: {
				type: Boolean,
				value: true
			}
		},

		ready: function(){
			this.isRendererPresent();
		},

		typeofRenderer: function(type, current) {
			if(Amble.Graphics[type] && (current instanceof Amble.Graphics[type])) {
				return false;
			} else {
				return true;
			}
		},

		isRendererPresent: function(){
			if(this.actor.renderer) {
				this.hideContent = false;
				this.hideRenderer = false;
			} else {
				this.hideContent = true;
				this.hideRenderer = true;
			}
		},

		refreshActor: function() {

			this.sprites = Amble.app.loader.cache.filter(c => c.type === 'image');

			if(this.actor.sceneID) {
				var sceneID = this.actor.sceneID;
				this.actor = Amble.app.scene.getActorByID(sceneID);

				this.isRendererPresent();
			}
		},

		selected: function(item, type){
			return type == item;
		},

		spriteChange: function(e){
			if(this.actor instanceof Amble.Actor) {
				this.actor.renderer.sprite = e.target.value;
			}
		},

		hideComponent: function(){
			if(this.actor.renderer) {
				this.hideContent = !this.hideContent;
			}
			// this.isRendererPresent();
		}

	});

</script>
