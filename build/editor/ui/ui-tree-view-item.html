<link rel="import" href="../../../bower_components/polymer/polymer.html">

<link rel="import" href="../../../bower_components/iron-collapse/iron-collapse.html">

<dom-module id="ui-tree-view-item">

	<style>

  :host {
    cursor: pointer;
    display: inline;
  }

  .head:hover {
    background-color: rgba(0, 0, 0, 0.5);
  }

  a {
    text-decoration: none;
    color: white;
  }

  li {
    text-overflow: ellipsis;
  }

  li > ul {
    margin-left: 5px;
  }

  ul {
    list-style: none;
    padding-left: 15px;
    margin: 0;
  }

  .icon {
  }

	</style>

	<template>

    <li>

      <!-- header with name and icon -->
      <div class="head" on-click="toggle">
        <span >
          <!-- <i class="fa fa-caret-right" hidden$="{{hasChild()}}"></i> -->
          <i class="fa fa-folder icon"></i>
        </span>
        {{item.text}}
      </div>

      <!-- collapse with children -->
      <iron-collapse id="collapse">
        <ul>
          <template is="dom-repeat" items="{{ item.children }}" as="child" filter="isFolder">
            <ui-tree-view-item id="{{child.id}}" item="{{child}}"></ui-tree-view-item>
          </template>
        </ul>
      </iron-collapse>

    </li>

	</template>

</dom-module>

<script>

	Polymer({
		is: 'ui-tree-view-item',

		properties: {

      item: {
        type: Object,
        value: null
      },

    },

    ready: function() {
      if(this.item.text == 'assets') {
        this.$.collapse.toggle();
      }
    },

    // onClick: function(e) {
    //   e.stopPropagation();
    //
    // },

    hasChild: function() {
      for(var i = 0; i < this.item.children.length; i++) {
        if(this.item.children[i].type == 'folder') return false;
      }
      return true;
    },

    isFolder: function(item) {
      return item.type == 'folder';
    },

    toggle: function(e) {
      if(!this.hasChild()) {
        this.$.collapse.toggle();
      }

      this.async(() => this.fire('folder-click'), 1);
    }

	});

</script>
